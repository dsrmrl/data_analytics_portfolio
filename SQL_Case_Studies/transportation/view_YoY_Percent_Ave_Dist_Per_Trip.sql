CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `yoy_percent_ave_dist_per_trip` AS select `t`.`year` AS `year`,`t`.`mode` AS `mode`,`t`.`CurrYr` AS `CurrYr`,`t`.`PrevYr` AS `PrevYr`,round(((cast((`t`.`CurrYr` - `t`.`PrevYr`) as float) / `t`.`PrevYr`) * 100),2) AS `YoY_Percent_ave_dist_per_trip` from (select `publictransportutilisationaveragetripdistance`.`year` AS `year`,`publictransportutilisationaveragetripdistance`.`mode` AS `mode`,`publictransportutilisationaveragetripdistance`.`ave_distance_per_trip` AS `CurrYr`,lead(`publictransportutilisationaveragetripdistance`.`ave_distance_per_trip`,1) OVER (PARTITION BY `publictransportutilisationaveragetripdistance`.`mode` ORDER BY `publictransportutilisationaveragetripdistance`.`year` desc )  AS `PrevYr` from `publictransportutilisationaveragetripdistance`) `t`