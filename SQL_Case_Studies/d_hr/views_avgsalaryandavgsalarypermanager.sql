CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `d_hr`.`avg_salary_and_avg_salary_per_manager` AS select `d_hr`.`records_of_managers_per_employee`.`employee_id` AS `employee_id`,`d_hr`.`records_of_managers_per_employee`.`employee` AS `employee`,`d_hr`.`records_of_managers_per_employee`.`job_title` AS `job_title`,`d_hr`.`records_of_managers_per_employee`.`salary` AS `salary`,`d_hr`.`records_of_managers_per_employee`.`manager` AS `manager`,round(avg(`d_hr`.`records_of_managers_per_employee`.`salary`) OVER () ,0) AS `avgsalary`,round(avg(`d_hr`.`records_of_managers_per_employee`.`salary`) OVER (PARTITION BY `d_hr`.`records_of_managers_per_employee`.`manager` ) ,0) AS `avgsalary_per_manager` from `d_hr`.`records_of_managers_per_employee`