CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `db_covid`.`top10_in_total_cases_per_year` AS select `t`.`_rank` AS `_rank`,`t`.`_Yr` AS `_Yr`,`t`.`continent` AS `continent`,`t`.`location` AS `location`,`t`.`_total_case` AS `_total_case` from (select rank() OVER (PARTITION BY year(`db_covid`.`owid-covid-data`.`date`) ORDER BY sum(`db_covid`.`owid-covid-data`.`total_cases`) desc )  AS `_rank`,year(`db_covid`.`owid-covid-data`.`date`) AS `_Yr`,`db_covid`.`owid-covid-data`.`continent` AS `continent`,`db_covid`.`owid-covid-data`.`location` AS `location`,sum(`db_covid`.`owid-covid-data`.`total_cases`) AS `_total_case` from `db_covid`.`owid-covid-data` group by year(`db_covid`.`owid-covid-data`.`date`),`db_covid`.`owid-covid-data`.`continent`,`db_covid`.`owid-covid-data`.`location` order by `_Yr`,`_total_case` desc) `t` where (`t`.`_rank` <= 10) order by `t`.`_Yr` desc,`t`.`_rank`