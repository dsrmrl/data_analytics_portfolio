CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `db_covid`.`survival_and_mortality_rate_by_yr_per_continent` AS select `t`.`continent` AS `continent`,`t`.`_Yr` AS `_Yr`,`t`.`rank_cases` AS `rank_cases`,`t`.`_total_cases` AS `_total_cases`,`t`.`rank_deaths` AS `rank_deaths`,`t`.`_total_deaths` AS `_total_deaths`,`t`.`_diff` AS `_diff`,dense_rank() OVER (PARTITION BY `t`.`continent` ORDER BY round(((`t`.`_diff` / `t`.`_total_cases`) * 100),1) desc )  AS `rank_survival`,round(((`t`.`_diff` / `t`.`_total_cases`) * 100),1) AS `survival_rate`,round(((`t`.`_total_deaths` / `t`.`_total_cases`) * 100),1) AS `mortality_rate` from (select `db_covid`.`owid-covid-data`.`continent` AS `continent`,year(`db_covid`.`owid-covid-data`.`date`) AS `_Yr`,rank() OVER (PARTITION BY `db_covid`.`owid-covid-data`.`continent` ORDER BY sum(`db_covid`.`owid-covid-data`.`total_cases`) desc )  AS `rank_cases`,sum(`db_covid`.`owid-covid-data`.`total_cases`) AS `_total_cases`,rank() OVER (PARTITION BY `db_covid`.`owid-covid-data`.`continent` ORDER BY sum(`db_covid`.`owid-covid-data`.`total_deaths`) desc )  AS `rank_deaths`,sum(`db_covid`.`owid-covid-data`.`total_deaths`) AS `_total_deaths`,(sum(`db_covid`.`owid-covid-data`.`total_cases`) - sum(`db_covid`.`owid-covid-data`.`total_deaths`)) AS `_diff` from `db_covid`.`owid-covid-data` group by `db_covid`.`owid-covid-data`.`continent`,year(`db_covid`.`owid-covid-data`.`date`)) `t` order by `t`.`continent`,`t`.`_Yr` desc