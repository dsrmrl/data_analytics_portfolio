CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `db_covid`.`total_cases_by_continent_per_year` AS select `t`.`_Yr` AS `_Yr`,`t`.`continent` AS `continent`,`t`.`total_case_perContinent` AS `total_case_perContinent`,rank() OVER (PARTITION BY `t`.`continent` ORDER BY `t`.`total_case_perContinent` desc )  AS `_rank`,lag(`t`.`total_case_perContinent`,1) OVER (PARTITION BY `t`.`continent` ORDER BY `t`.`_Yr` )  AS `PrevYr`,(`t`.`total_case_perContinent` - lag(`t`.`total_case_perContinent`,1) OVER (PARTITION BY `t`.`continent` ORDER BY `t`.`_Yr` ) ) AS `variance`,sum(`t`.`total_case_perContinent`) OVER (PARTITION BY `t`.`continent` )  AS `overAll_totalperContinent`,((`t`.`total_case_perContinent` / sum(`t`.`total_case_perContinent`) OVER (PARTITION BY `t`.`continent` ) ) * 100) AS `percent_byContinent`,sum(`t`.`total_case_perContinent`) OVER ()  AS `overAll_total`,((`t`.`total_case_perContinent` / sum(`t`.`total_case_perContinent`) OVER () ) * 100) AS `percent_overAll` from (select year(`db_covid`.`owid-covid-data`.`date`) AS `_Yr`,`db_covid`.`owid-covid-data`.`continent` AS `continent`,sum(`db_covid`.`owid-covid-data`.`total_cases`) AS `total_case_perContinent` from `db_covid`.`owid-covid-data` group by year(`db_covid`.`owid-covid-data`.`date`),`db_covid`.`owid-covid-data`.`continent` order by `db_covid`.`owid-covid-data`.`continent`,`_Yr`) `t`