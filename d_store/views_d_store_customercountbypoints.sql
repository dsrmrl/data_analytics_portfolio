CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `d_store`.`customer_count_by_points` AS select (case when (`d_store`.`customers`.`points` >= 3000) then 'Gold' when (`d_store`.`customers`.`points` >= 2000) then 'Silver' when (`d_store`.`customers`.`points` >= 1000) then 'Bronze' else 'Basic' end) AS `membership`,count(0) AS `count` from `d_store`.`customers` group by `membership` order by field(`membership`,'Gold','Silver','Bronze','Basic')